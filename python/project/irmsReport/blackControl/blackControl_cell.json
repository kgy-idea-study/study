{
  "name": "black_control_cell",
  "Description": "装维黑点管控（小区）",
  "sql": "select c.*,\n       case\n         when BYPM <= 10 and BYPM1 <= 10 then\n          '否'\n         else\n          '是'\n       end SFZP\n  from (select b.*,\n               get_rate(b.BLZJDZL, b.ZJDZL) ZJBLL,\n               get_rate(b.BLTSDZL, b.TSDZL) TSBLL,\n               get_rate(b.BLGDZL, b.ZJTSGDL) ZBLL,\n               dense_rank() over(order by BLGDZL desc) BYPM,\n               dense_rank() over(order by BLGDZL1 desc) BYPM1\n          from (select CITY,\n          COUNTYNAME,\n                       PROVINCE_UNIT,\n                       CITY_UNIT,\n                       MAINTAIN_COMPANY,\n                       MAINTENANCE_NAME,\n                       a.CELL_CODE,\n                          a.CELL_NAME,\n                       sum(ZJ_CCGD) ZJ_CCGD,\n                       sum(ZJ_CCZT) ZJ_CCZT,\n                       sum(ZJ_CSGDGDL) ZJ_CSGDGDL,\n                       sum(ZJ_CSZTGDL) ZJ_CSZTGDL,\n                       sum(ZJ_BMYGDL) ZJ_BMYGDL,\n                       sum(ZJ_TCDL) ZJ_TCDL,\n                       sum(ZJ_GGLBDB) ZJ_GGLBDB,\n                       sum(TS_CCGD) TS_CCGD,\n                       sum(TS_CCZT) TS_CCZT,\n                       sum(TS_CSGDGDL) TS_CSGDGDL,\n                       sum(TS_CSZTGDL) TS_CSZTGDL,\n                       sum(TS_BMYGDL) TS_BMYGDL,\n                       sum(TS_CFTS) TS_CFTS,\n                       sum(BLZJDZL) BLZJDZL,\n                       sum(ZJDZL) ZJDZL,\n                       sum(BLTSDZL) BLTSDZL,\n                       sum(TSDZL) TSDZL,\n                       sum(BLGDZL) BLGDZL,\n                       sum(ZJTSGDL) ZJTSGDL,\n                       sum(BLGDZL1) BLGDZL1,\n                       COUNT_TIME\n                  from BLACK_CONTROL a\n                  where a.COUNT_TIME = to_date('#统计时间#','yyyy-mm-dd hh24:mi:ss')\n                 group by a.CITY,\n                 a.COUNTYNAME,\n                          a.PROVINCE_UNIT,\n                          a.CITY_UNIT,\n                          a.MAINTAIN_COMPANY,\n                          a.MAINTENANCE_NAME,\n                          a.CELL_CODE,\n                          a.CELL_NAME,\n                          a.COUNT_TIME) b) c;\n",
  "COLUMNS": [
    {"id": "CITY", "name": "地市", "Description": "地市","parent": ""},
    {"id": "COUNTYNAME", "name": "区县", "Description": "区县","parent": ""},
    {"id": "PROVINCE_UNIT", "name": "省装维", "Description": "省装维","parent": ""},
    {"id": "CITY_UNIT", "name": "市装维", "Description": "市装维","parent": ""},
    {"id": "MAINTAIN_COMPANY", "name": "维服区", "Description": "维服区","parent": ""},
    {"id": "MAINTENANCE_NAME", "name": "网格", "Description": "网格","parent": ""},
    {"id": "CELL_NAME", "name": "小区", "Description": "小区","parent": ""},
    {"id": "CELL_CODE", "name": "小区编码", "Description": "小区编码","parent": ""},
    {"id": "ZJ_CCGD", "name": "装机-超长归档", "Description": "超长归档","parent": "装机"},
    {"id": "ZJ_CCZT", "name": "装机-超长在途", "Description": "超长在途","parent": "装机"},
    {"id": "ZJ_CSGDGDL", "name": "装机-超时归档工单量", "Description": "超时归档工单量","parent": "装机"},
    {"id": "ZJ_CSZTGDL", "name": "装机-超时在途工单量", "Description": "超时在途工单量","parent": "装机"},
    {"id": "ZJ_BMYGDL", "name": "装机-不满意工单", "Description": "不满意工单","parent": "装机"},
    {"id": "ZJ_TCDL", "name": "装机-退撤单量", "Description": "退撤单量","parent": "装机"},
    {"id": "ZJ_GGLBDB", "name": "装机-光功率不达标", "Description": "光功率不达标","parent": "装机"},
    {"id": "TS_CCGD", "name": "投诉-超长归档", "Description": "超长归档","parent": "投诉"},
    {"id": "TS_CCZT", "name": "投诉-超长在途", "Description": "超长在途","parent": "投诉"},
    {"id": "TS_CSGDGDL", "name": "投诉-超时归档工单量", "Description": "超时归档工单量","parent": "投诉"},
    {"id": "TS_CSZTGDL", "name": "投诉-超时在途工单量", "Description": "超时在途工单量","parent": "投诉"},
    {"id": "TS_BMYGDL", "name": "投诉-不满意工单量", "Description": "不满意工单量","parent": "投诉"},
    {"id": "TS_CFTS", "name": "投诉-重复投诉", "Description": "重复投诉","parent": "投诉"},
    {"id": "BLZJDZL", "name": "不良装机单总量", "Description": "不良装机单总量","parent": "不良情况"},
    {"id": "ZJDZL", "name": "装机单总量", "Description": "装机单总量","parent": "不良情况"},
    {"id": "ZJBLL", "name": "装机不良率", "Description": "装机不良率","parent": "不良情况"},
    {"id": "BLTSDZL", "name": "不良投诉单总量", "Description": "不良投诉单总量","parent": "不良情况"},
    {"id": "TSDZL", "name": "投诉单总量", "Description": "投诉单总量","parent": "不良情况"},
    {"id": "TSBLL", "name": "投诉不良率", "Description": "投诉不良率","parent": "不良情况"},
    {"id": "BLGDZL", "name": "不良工单总量", "Description": "不良工单总量","parent": "不良情况"},
    {"id": "ZJTSGDL", "name": "装机投诉工单总量", "Description": "装机投诉工单总量","parent": "不良情况"},
    {"id": "ZBLL", "name": "总不良率", "Description": "总不良率","parent": "不良情况"},
    {"id": "BLGDZL1", "name": "不良工单总量上月", "Description": "不良工单总量(上月)","parent": "不良情况"},
    {"id": "BYPM", "name": "本月排名", "Description": "本月排名","parent": "不良情况"},
    {"id": "SFZP", "name": "是否摘牌", "Description": "是否摘牌","parent": "不良情况"},
    {"id": "COUNT_TIME", "name": "统计时间", "Description": "统计时间","parent": ""}
  ]
}
